<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="web_style_1.css">
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>GEANT4 Cherenkov Detector</title>
    </head>

<nav>
    <h1>Navigation</h1>
    <ul>
    <li><a display:inline href="./index">Home</a></li>
    <li><a display:inline href="./about">About</a></li>
    <li><a display:inline href="./physics_projects">Physics Projects</a></li>
    <li><a display:inline href="./computer_projects">Computer Projects</a></li>
    <li><a display:inline href="./GEANT4_installation">GEANT4 Installation</a></li>
    <li><a display:inline href="./GEANT4_MT_installation">GEANT4 Multithreaded Installation</a></li>
    <li><a display:inline href="./GEANT4_cherenkov_detector">GEANT4 Cherenkov Detector</a></li>
    <li><a display:inline href="./ROOT">ROOT</a></li>
    <li><a display:inline href="./contact">Contact</a></li>
    <li><a display:inline href="./archive">Archive</a></li>
    </ul>
</nav>

    <article>
        <header>
            <h1>Building a Cherenkov Detector in GEANT4</h1>  
        </header>
        <br>
        <h2>Initial Setup</h2>
        <p>
        This page intends to detail the process of constructing a Cherenkov Detector and Particle Gun in Geant4, which will produce output files which can be analysed using the ROOT framework. Before begining this section, ensure you've completed the steps outlined in either the GEANT4 Installation page, or GEANT4 Multithreaded Installation page. From there, ensure you've referenced the appropriate version of your installation using the command at the bottom of the respective installation pages. The source code used throughout this project can be found on GitHub at <a href="https://github.com/Charlie-BrownGT/geant4-cherenkov-detector.git">Cherenkov Detector</a>.
        </p>
        <br>
        <p>
        To begin making a project, create a new directory from your landing directory named an appropriate title. Here, I've called mine geant4-cherenkov-detector. There are a number of different methods you can use to make your projects in GEANT4, here I'll use CMAKE. With this in mind, navigate into your project directory and create a file named 'CMakeLists.txt'. Within this file you'll need to specify the minimum cmake version required to comile your code, here I've specified version 2.6. Next you'll need to name the project, I've called mine 'cherenkov_detector'. Next you need to tell cmake to find GEANT4, this will use the package that you've referenced prevously (geant4make.sh) when compiling your project, and state that this is required. Within this command you also need to specify that you'll need user interface and visualisation options. You also need to add the 'include' files that come with GEANT4. Then you need to compile all the source and header files that you have in your project folder. You need to define the name of the executable for your project, this will provide the name of the programme which you will run when you run your programme, here mine is named 'sim'. You will also likely need to reference other libraries present in GEANT4 during your project, this is enabled with the 'target_link_libraries' command. Then lastly, you'll also need to add the target for your simulation. 
        </p>
        <br>
        <p>
        Next create a new file named something like 'sim.cc', which will provide the main body for your simulation. Pay particular attention here to the functionality that you include within your headers. Once the base  is setup, the next, and likely most important step, is to create the G4RunManager, this is effectively the heart of your Geant4 instance. To achieve this, you'll need to initialize several managers, principally G4UIManager, G4VisManager and G4UIExecutive. Once created you will also need to initialize your G4visManager and start your UI session. With the elements of your sim.cc file complete you can create a new directory in your project file, I've named mine 'build'. Moving into your new directory you can add and compile your work so far using the 'cmake ..' and 'make' command. Once these are complete you can run your project using the './sim' command from the terminal. This should launch a blank GEANT4 terminal without any content.
        </p>
        <br>
        <h2>Detector Construction</h2>
        <br>
        <p>
        To begin building a detector, the construction will need to pull on several other classes of the GEANT4 package. As such, it's recommended that these elements are stored in a seperate set of files named 'construction.cc' and 'construction.hh'. This construction is named 'MyDetectorConstruction', but could equally be named anything. This class should remain public and inherits from the 'G4UserDetectorConstruction' class. Here it also includes both constructor and destructor, these will become increasingly common throughout the project in the different '.cc' and '.hh' files. The most important part of this class remains the 'G4VPhysicalVolume' element as this will be where the final detector volume is contructed from. This is a virtual function as it's otherwise defined in the overall G4UserDetectorConstruction class. 
        </p>
        <br>
        <p>
        The 'contruction.cc' file begins by including the 'consturction.hh' file, again this will prove common throughout, then moves to define both the constructor and destructor. The next step is to formally outline the role of the new G4VPhysicalVolume function. This begins by defining the materials that will be used within the detector. Rather then defnining all materials from scratch, you can use the pre-defined materials within GEANT4 by calling on the G4NistManager tool. In this example, the variable 'worldMat' has been defined, then filled with the material titled 'G4_AIR'. Next the world volume needs to be defined, this is the space in which all results will be returned. In this example the 'G4Box' function in used to created a simple box. Every volume that you create in GEANT4 needs to contain three parts, the solid volume - defining the size, the logical volume - defining the material and the physical volume - which places the volume within the simulation and applies any translation or movement. 
        </p>
        <br>
        <p>
        Each of these volumes will take different variables during their definition, the examples used here aim to keep the definitions as simple as possible. It should be noted, the standard units of measurement within GEANT4 can vary, so it is useful to specify exactly which units you're using. Here the units of measurement can come predefined in the 'G4SystemOfUnits' package, included in the header file. Once the G4Box and G4_AIR pieces are defined, you need to instruct GEANT4 to place the material inside the box - this is done by defining the logical volume. Thirdly, you need to define the physical volume, this uses the class 'G4PVPlacement'. The arguments included here are rotation, central point (via G4ThreeVector), logical volume, name, whether this volume should be placed in another mother volume, any boolean operation, copy number of logical volume and whether the function should check for overlaps. Once these volumes are defined you can return the highest level mother volume - in this case 'physWorld'.
        </p>
        <br>
        <p>
        With these steps in place we can tell GEANT4 to use the geometry that we've just created. This is done in the sim.cc file via the run manager. A point here, be sure to include all the relevant header files to allow your programme to call the respective parts of GEANT4. 
        </p>
        <br>
        <h2>Implementing a Physics List</h2>
        <p>
        The Physics List is used to determine how a particle interacts with the detector construction. This is required before any simulations can run. The Physics List is implemented by creating a new class, in this case called 'MyPhysicsList', this inherits from the class 'G4VModularPhysicsList'. With this in mind, we begin by creating two new files 'physics.cc' and 'physics.hh'. Both files here include the standard definitions including constructor, destructor, public inheritence, then the body of the definition sits in the 'MyPhysicsList.cc' file. 
        </p>
        <br>
        <p>
        Within the 'physics.cc' file, you begin by implementing the required physics for the simulation that you're running. In this case, noting that we're making a Cherenkov Detector, we need the standard EM physics and optical physics list, although there are others that are pre-defined within the GEANT4 package. The different types of physics will also need to be included within the header file. With these steps complete, you need to define your Physics List within the main 'sim.cc' file to ensure it's included within the simulation. You also need to initialize the Physics List, in the same manner that the construction was initialized. 
        </p>
        <br>
        <p>
        With these steps complete, the final step required to produce a visual output is to direct GEANT4 to display. This is achieved by using the previously defined UI manager and applying the command "/vis/open OGL" within the 'sim.cc' folder and telling GEANT4 to draw the volume using the "/vis/drawVolume" command. When re-compiled and executed, this should produce a visual representation of your detector box. You can also use the "/vis/viewer/set/viewpointVector 1 1 1" command (via UIManager) to set the default view point that the simulation will launch from. 
        </p>
</html>
